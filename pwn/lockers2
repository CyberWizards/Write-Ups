<h2 style="text-align: left;">&nbsp;Lockers2</h2><p>Lockers2 is a binary exploitation challenge, which basically focused on controlling a buffer overflow,</p><p>So let's begin,</p><p>Ok on running the ./lockers2 binary, the first thing I saw was this:-</p><div class="separator" style="clear: both; text-align: left;"><a href="https://1.bp.blogspot.com/-43NH891DF5Y/X0E5fuy_jZI/AAAAAAAAGFc/zIxOhX9nE7oYX2XwTMjV5P85qQH7HL6PQCLcBGAsYHQ/s452/1.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="269" data-original-width="452" src="https://1.bp.blogspot.com/-43NH891DF5Y/X0E5fuy_jZI/AAAAAAAAGFc/zIxOhX9nE7oYX2XwTMjV5P85qQH7HL6PQCLcBGAsYHQ/s0/1.png" /></a></div><p>Next, I tried inputting some text to see it's behavior,</p><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: left;"><a href="https://1.bp.blogspot.com/-gs05gWczR4s/X0E5sqHGfXI/AAAAAAAAGFg/24JthBVMJ4QyDhsp-AniJKUZY8VWYbqlACLcBGAsYHQ/s464/2.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="264" data-original-width="464" src="https://1.bp.blogspot.com/-gs05gWczR4s/X0E5sqHGfXI/AAAAAAAAGFg/24JthBVMJ4QyDhsp-AniJKUZY8VWYbqlACLcBGAsYHQ/s0/2.png" />&nbsp;</a></div><div class="separator" style="clear: both; text-align: left;">&nbsp;</div><div class="separator" style="clear: both; text-align: left;">The output I received said "Low efforts? Try again." , What this message meant was that, we need to put in more characters, so that's what I did,</div><div class="separator" style="clear: both; text-align: left;">&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-F8al1LLw7ko/X0E6POFhpQI/AAAAAAAAGFo/XtwhNElx--oFH9bKxY_C2tTgtpl7E3agACLcBGAsYHQ/s886/3.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="268" data-original-width="886" src="https://1.bp.blogspot.com/-F8al1LLw7ko/X0E6POFhpQI/AAAAAAAAGFo/XtwhNElx--oFH9bKxY_C2tTgtpl7E3agACLcBGAsYHQ/s640/3.png" width="640" /></a></div>&nbsp;</div><div class="separator" style="clear: both; text-align: left;">And now we see that, we gave too many characters as input, now is the time where I tried to make sense of the source code that was provided, <br /></div><div class="separator" style="clear: both; text-align: left;">&nbsp;<div class="separator" style="clear: both; text-align: left;"><a href="https://1.bp.blogspot.com/-XzZ1o3vIlDY/X0E7LnuwxZI/AAAAAAAAGF0/YGKcGThaRog29a0Z31w147W4kAMDdmTRgCLcBGAsYHQ/s255/4.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="98" data-original-width="255" src="https://1.bp.blogspot.com/-XzZ1o3vIlDY/X0E7LnuwxZI/AAAAAAAAGF0/YGKcGThaRog29a0Z31w147W4kAMDdmTRgCLcBGAsYHQ/s0/4.png" /></a></div></div><div class="separator" style="clear: both; text-align: left;">&nbsp;</div><div class="separator" style="clear: both; text-align: left;">&nbsp;This is the code that caught my attention, it looks like the address assigned to secret is <u><b>0xdeadbeef </b></u>and the value of <b>buff </b>is 32 bytes in hex which is 50 bytes in decimal.<br /><b></b><u><b></b></u></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">So as there was a little <b>padding</b> involved I had to manually test out and find that we need 56 characters to overwrite the value of secret. </div><div class="separator" style="clear: both; text-align: left;"><b>&nbsp;</b><br /></div><div class="separator" style="clear: both; text-align: left;"><a href="https://1.bp.blogspot.com/-PJGlN1B-T4c/X0E8JubOdFI/AAAAAAAAGGA/55XnhLYBzdQJBp96TtAM82e6GWyHCVYTwCLcBGAsYHQ/s591/5.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="484" data-original-width="591" src="https://1.bp.blogspot.com/-PJGlN1B-T4c/X0E8JubOdFI/AAAAAAAAGGA/55XnhLYBzdQJBp96TtAM82e6GWyHCVYTwCLcBGAsYHQ/s0/5.png" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The command is used is:-</div><div class="separator" style="clear: both; text-align: left;"><br /></div><!--HTML generated using hilite.me--><div style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; border: medium solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0px;">python <span style="color: #333333;">-</span>c <span style="background-color: #fff0f0;">"print 'A'*56"</span> <span style="color: #333333;">|</span> <span style="color: #333333;">./</span>locker2<span style="color: #333333;">.</span>c
</pre></div>
<div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Ok, so we have overflowed the secret value, next we need to use this to grab the flag.<br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Now, on further examining the source code, I figured that, we need to overwrite the value of secret to another address in order to get the flag,<div class="separator" style="clear: both; text-align: left;"><a href="https://1.bp.blogspot.com/-WN7T8l9R4qw/X0E_JH6v4_I/AAAAAAAAGGM/pThxu0LrvQQaNgVuopIJTVSlFO8TNz8wwCLcBGAsYHQ/s414/6.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="92" data-original-width="414" src="https://1.bp.blogspot.com/-WN7T8l9R4qw/X0E_JH6v4_I/AAAAAAAAGGM/pThxu0LrvQQaNgVuopIJTVSlFO8TNz8wwCLcBGAsYHQ/s0/6.png" /></a></div><br /></div><div class="separator" style="clear: both; text-align: left;">&nbsp;If we somehow input this address with our payload, we can get the flag</div><div class="separator" style="clear: both; text-align: left;">&nbsp;To do that I used the following command:- <br /></div><div class="separator" style="clear: both; text-align: left;">&nbsp;</div><!--HTML generated using hilite.me--><div style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; border: medium solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0px;">python <span style="color: #333333;">-</span>c <span style="background-color: #fff0f0;">"print 'A'*56 + '</span><span style="background-color: #fff0f0; color: #666666; font-weight: bold;">\x66\x6c\x61\x67</span><span style="background-color: #fff0f0;">' "</span><span style="color: #333333;">|</span> <span style="color: #333333;">./</span>locker2
</pre></div>
<div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><a href="https://1.bp.blogspot.com/-UdXdh7PonZY/X0E_Yn1LSOI/AAAAAAAAGGQ/Kwbz0fdqRF0avpzm-9PxPGSaVI38zhtQQCLcBGAsYHQ/s654/7.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="486" data-original-width="654" src="https://1.bp.blogspot.com/-UdXdh7PonZY/X0E_Yn1LSOI/AAAAAAAAGGQ/Kwbz0fdqRF0avpzm-9PxPGSaVI38zhtQQCLcBGAsYHQ/s640/7.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">And we broke into the vault!!!</div><div class="separator" style="clear: both; text-align: left;">But to grab the flag you have to replace the <b>./locker2 </b>with the domain that they provided.<br /></div>
